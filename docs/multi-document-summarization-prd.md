# 다중 문서 요약 시스템 PRD (Phase 9)
**Product Requirements Document**

## 1. 제품 개요

### 1.1 프로젝트 명
Vault Intelligence System V2 - 다중 문서 요약 시스템 (Phase 9)

### 1.2 프로젝트 배경
현재 Vault Intelligence System V2는 Phase 1-8을 통해 BGE-M3 기반 고품질 검색, 자동 태깅, 지식 그래프, MOC 생성 등의 기능을 완성했습니다. Phase 9에서는 대용량 문서 컬렉션에서 의미적으로 관련된 문서들을 자동으로 그룹화하고 요약하는 시스템을 구축하여, "AI 시대의 TDD 활용" 책 저술과 연구 활동을 더욱 효율적으로 지원합니다.

### 1.3 핵심 가치 제안
- **순수 콘텐츠 기반 그룹화**: 폴더 구조에 의존하지 않고 문서의 실제 내용 유사도만으로 관련 문서 발견
- **비용 효율적 요약**: 유료 API 없이 Claude Code 내장 시스템만으로 고품질 요약 생성
- **시간 기반 학습 추적**: 주간/월간 단위로 지식 축적 과정을 체계적으로 리뷰

## 2. 비즈니스 목표

### 2.1 주요 목표
1. **저술 효율성 향상**: "AI 시대의 TDD 활용" 책 저술을 위한 관련 자료의 체계적 정리 및 통합
2. **연구 생산성 증대**: 대용량 문헌 조사 결과를 주제별로 자동 요약하여 분석 시간 단축
3. **학습 과정 가시화**: 개인의 지식 축적 패턴과 학습 진전도를 정량적으로 추적

### 2.2 성공 지표
- **요약 품질**: 사용자 만족도 90% 이상 (5점 척도 4.5점 이상)
- **시간 절약**: 수동 요약 대비 70% 이상 시간 단축
- **발견 효율성**: 기존에 놓친 관련 문서 발견률 30% 이상 향상

## 3. 사용자 페르소나

### 3.1 기술서 저자 (Primary)
- **배경**: "AI 시대의 TDD 활용" 책을 저술하는 소프트웨어 아키텍트
- **요구사항**: TDD, 리팩토링, 클린코드 관련 수백 개 문서를 주제별로 체계적 정리
- **페인 포인트**: 폴더별로 흩어진 관련 자료를 일일이 찾아서 정리하는 번거로움
- **기대 결과**: 주제별 핵심 내용을 한눈에 파악할 수 있는 자동 요약

### 3.2 연구자 (Secondary)
- **배경**: 소프트웨어 개발 방법론 연구자
- **요구사항**: 최신 개발 트렌드와 기법에 대한 포괄적 이해
- **페인 포인트**: 방대한 학술 자료와 기술 문서의 효율적 분석
- **기대 결과**: 연구 분야별 핵심 인사이트 자동 추출

### 3.3 개발자 학습자 (Tertiary)  
- **배경**: TDD, 클린코드를 학습하는 시니어 개발자
- **요구사항**: 체계적 학습 과정 관리 및 진전도 추적
- **페인 포인트**: 학습한 내용의 연결고리 파악 어려움
- **기대 결과**: 주간/월간 학습 리뷰를 통한 지식 체계화

## 4. 기능 요구사항

### 4.1 핵심 기능

#### 4.1.1 의미적 문서 클러스터링
- **기능**: BGE-M3 임베딩 기반 문서 유사도 계산으로 관련 문서 자동 그룹화
- **특징**:
  - 폴더 구조 완전 무시, 순수 콘텐츠 기반 그룹화
  - K-means, DBSCAN 등 다양한 클러스터링 알고리즘 지원
  - 최적 클러스터 수 자동 결정 (Elbow method, Silhouette analysis)
  - 클러스터별 대표 문서 및 핵심 키워드 추출

#### 4.1.2 Claude Code 기반 그룹 요약
- **기능**: 클러스터링된 문서 그룹을 Claude Code 내장 LLM으로 요약
- **특징**:
  - Task 도구의 general-purpose 에이전트 활용
  - 유료 API 완전 배제, 내장 시스템만 사용
  - 문서 그룹별 핵심 내용, 주요 개념, 실용적 인사이트 추출
  - 사용자 지정 요약 스타일 (간략형/상세형/기술적/개념적)

#### 4.1.3 주간/월간 학습 리뷰 생성
- **기능**: 시간 기반 문서 활동 분석으로 학습 진행 상황 자동 리포트
- **특징**:
  - 문서 생성/수정 시간 분석으로 학습 활동 패턴 파악
  - 주제별 학습 진전도 및 지식 축적 추이 시각화
  - 취약 영역 식별 및 추가 학습 권장 사항 제공
  - 학습 목표 대비 성취도 평가

### 4.2 부가 기능

#### 4.2.1 요약 품질 피드백 시스템
- 사용자 평가 기반 요약 품질 개선
- 선호 스타일 학습 및 개인화

#### 4.2.2 다국어 요약 지원
- 한국어/영어 혼재 문서의 자연스러운 요약
- 기술 용어의 일관성 있는 처리

## 5. 사용자 경험 및 인터페이스

### 5.1 CLI 명령어 설계

#### 5.1.1 문서 그룹 요약
```bash
# 기본 그룹 요약
python -m src summarize --clusters 5

# 특정 주제 중심 요약
python -m src summarize --topic "TDD" --style detailed

# 최근 문서만 대상으로 요약
python -m src summarize --since "2024-01-01" --clusters auto

# 출력 파일 지정
python -m src summarize --topic "리팩토링" --output refactoring-summary.md

# 요약 스타일 옵션
python -m src summarize --style brief|detailed|technical|conceptual
```

#### 5.1.2 학습 리뷰 생성
```bash
# 주간 학습 리뷰
python -m src review --period weekly

# 월간 학습 리뷰  
python -m src review --period monthly --output monthly-review.md

# 특정 기간 리뷰
python -m src review --from "2024-08-01" --to "2024-08-31"

# 주제별 학습 진전도 분석
python -m src review --topic "TDD" --period quarterly
```

### 5.2 출력 형식

#### 5.2.1 문서 그룹 요약 출력
```markdown
# 문서 그룹 요약 리포트

## 🎯 클러스터 1: TDD 기본 개념 (15개 문서)

### 📋 핵심 내용
- 테스트 주도 개발의 Red-Green-Refactor 사이클
- 단위 테스트 작성의 기본 원칙
- 테스트 가능한 코드 설계 패턴

### 🔑 주요 키워드
TDD, 단위테스트, 리팩토링, 테스트 케이스, 어서션

### 📚 관련 문서 (유사도 순)
1. [TDD 기본 개념.md](TDD%20기본%20개념.md) - 0.92
2. [단위 테스트 작성법.md](단위%20테스트%20작성법.md) - 0.89
...

### 💡 실용적 인사이트
- TDD는 설계 도구로서의 가치가 테스트 자체보다 중요
- 작은 단위로 반복하는 것이 성공의 핵심
```

#### 5.2.2 학습 리뷰 출력
```markdown
# 주간 학습 리뷰 (2024년 8월 3주차)

## 📊 학습 활동 개요
- **문서 생성**: 8개
- **문서 수정**: 23개  
- **주요 학습 주제**: TDD, 클린코드, 리팩토링

## 📈 주제별 학습 진전도
### TDD (40% 성장)
- 새로운 개념: Mock 객체 활용법
- 심화 학습: 통합 테스트 전략
- 권장 다음 단계: BDD 개념 학습

### 클린코드 (25% 성장)
- 강화된 영역: 함수 분해 기법
- 취약한 영역: 객체지향 설계 원칙
```

## 6. 기술적 고려사항

### 6.1 시스템 아키텍처

#### 6.1.1 새로운 모듈 구조
```
src/
├── features/
│   ├── document_summarizer.py      # 새로운 모듈
│   ├── learning_reviewer.py        # 새로운 모듈
│   └── content_clusterer.py        # 새로운 모듈
└── utils/
    └── claude_code_integration.py  # Claude Code LLM 연동
```

#### 6.1.2 기존 시스템과의 통합
- **BGE-M3 임베딩 재활용**: 기존 캐시된 임베딩 벡터 활용으로 성능 최적화
- **TopicCollector 확장**: 기존 주제별 수집 기능과 시너지
- **MOC 생성 연동**: 요약 결과를 MOC 생성에 활용

### 6.2 Claude Code LLM 연동 방식

#### 6.2.1 Task 도구 활용
```python
# 문서 그룹 요약을 위한 에이전트 호출
task_result = self.task_tool.call(
    subagent_type="general-purpose",
    description="문서 그룹 요약 생성",
    prompt=f"""
    다음 {len(documents)}개 문서의 핵심 내용을 요약해주세요:
    
    {document_contents}
    
    요약 스타일: {summary_style}
    포커스: {focus_areas}
    """
)
```

#### 6.2.2 요약 품질 보장
- **청크 단위 처리**: 대용량 문서 그룹을 적정 크기로 분할
- **계층적 요약**: 개별 문서 → 소그룹 → 전체 그룹 순차 요약
- **일관성 검증**: 요약 간 중복 및 누락 내용 체크

### 6.3 성능 최적화

#### 6.3.1 클러스터링 최적화
- **임베딩 캐시 활용**: 기존 BGE-M3 임베딩 재사용으로 계산 시간 단축
- **점진적 클러스터링**: 대용량 문서셋에 대한 분할 정복 방식
- **클러스터 캐싱**: 클러스터링 결과 캐싱으로 재계산 방지

#### 6.3.2 요약 성능 관리
- **배치 처리**: 여러 문서 그룹 동시 요약
- **비동기 처리**: 장시간 요약 작업의 백그라운드 실행
- **진행률 표시**: 대용량 요약 작업의 실시간 진행 상황 표시

## 7. 사용자 스토리

### 7.1 Epic 1: 주제별 문서 그룹 요약

#### Story 1.1: 자동 문서 클러스터링
```
As a: 기술서 저자
I want to: vault 내 모든 TDD 관련 문서를 폴더 위치와 관계없이 자동으로 그룹화
So that: 흩어져 있는 관련 자료를 놓치지 않고 체계적으로 정리할 수 있다

Acceptance Criteria:
- BGE-M3 임베딩 기반 의미적 유사도로 문서 클러스터링
- 폴더 구조 완전 무시, 순수 콘텐츠 기반 그룹화
- 클러스터별 대표 문서 및 핵심 키워드 자동 추출
- 최적 클러스터 수 자동 결정 (사용자 설정 가능)
```

#### Story 1.2: 고품질 그룹 요약 생성
```
As a: 연구자
I want to: 클러스터링된 문서 그룹의 핵심 내용을 자동으로 요약
So that: 방대한 자료의 핵심을 빠르게 파악하고 연구에 활용할 수 있다

Acceptance Criteria:
- Claude Code 내장 LLM으로 고품질 요약 생성
- 유료 API 사용 없이 완전 로컬 처리
- 다양한 요약 스타일 지원 (간략/상세/기술적/개념적)
- 핵심 개념, 실용적 인사이트, 연관 문서 링크 포함
```

### 7.2 Epic 2: 학습 진행 추적 및 리뷰

#### Story 2.1: 주간 학습 활동 분석
```
As a: 개발자 학습자
I want to: 지난 주 동안의 학습 활동을 자동으로 분석하고 리포트 생성
So that: 학습 진전도를 객관적으로 파악하고 다음 학습 계획을 수립할 수 있다

Acceptance Criteria:
- 문서 생성/수정 시간 기반 학습 활동 패턴 분석
- 주제별 학습 진전도 정량 측정
- 취약 영역 식별 및 추가 학습 권장사항 제공
- 학습 목표 대비 성취도 평가
```

#### Story 2.2: 장기 학습 트렌드 분석
```
As a: 기술서 저자
I want to: 월간/분기별 학습 트렌드와 지식 축적 패턴을 분석
So that: 책 저술 과정에서의 지식 발전 과정을 추적하고 부족한 부분을 보완할 수 있다

Acceptance Criteria:
- 월간/분기별 학습 리뷰 자동 생성
- 주제별 지식 축적 추이 시각화
- 새로운 개념 학습과 기존 지식 심화의 균형 분석
- 저술 진행도와 연계한 지식 완성도 평가
```

### 7.3 Epic 3: 시스템 통합 및 사용성

#### Story 3.1: 기존 기능과의 시너지
```
As a: 시스템 사용자
I want to: 문서 요약 기능이 기존 검색, MOC 생성 기능과 연계되어 작동
So that: 통합된 워크플로우로 더욱 효율적인 지식 관리를 할 수 있다

Acceptance Criteria:
- 요약 결과를 바탕으로 한 고품질 MOC 자동 생성
- 주제별 검색 결과와 요약 내용의 교차 검증
- 관련 문서 추천 시 요약 정보 활용
- 지식 그래프에 요약 기반 노드 정보 통합
```

#### Story 3.2: 사용자 친화적 인터페이스
```
As a: 모든 사용자
I want to: 직관적이고 일관성 있는 CLI 명령어로 요약 기능 사용
So that: 복잡한 설정 없이 바로 원하는 결과를 얻을 수 있다

Acceptance Criteria:
- 기존 CLI 패턴과 일관성 있는 명령어 체계
- 풍부한 옵션과 유연한 파라미터 설정
- 실시간 진행률 표시 및 상세한 로그 제공
- 결과물의 다양한 출력 형식 지원 (MD, JSON, TXT)
```

## 8. 구현 우선순위 및 로드맵

### 8.1 Phase 9.1: 기본 문서 클러스터링 (2주)
**목표**: BGE-M3 기반 의미적 문서 클러스터링 구현

**주요 작업**:
- `ContentClusterer` 클래스 구현
- K-means, DBSCAN 클러스터링 알고리즘 적용
- 최적 클러스터 수 자동 결정 로직
- 클러스터별 대표 문서 및 키워드 추출
- 기본 CLI 명령어 `summarize --clusters N` 구현

**완료 기준**:
- 1000개 이상 문서에서 의미적 클러스터링 성공
- 클러스터 품질 실루엣 점수 0.5 이상 달성
- 폴더 구조와 무관한 순수 콘텐츠 기반 그룹화 검증

### 8.2 Phase 9.2: Claude Code LLM 기반 요약 (2주)
**목표**: 내장 LLM을 활용한 문서 그룹 요약 시스템 구현

**주요 작업**:
- `DocumentSummarizer` 클래스 구현  
- Claude Code Task 도구 연동 모듈 개발
- 계층적 요약 알고리즘 (개별 → 소그룹 → 전체)
- 다양한 요약 스타일 지원 (brief/detailed/technical/conceptual)
- 요약 품질 검증 및 피드백 시스템

**완료 기준**:
- 10-50개 문서 그룹의 일관성 있는 요약 생성
- 사용자 만족도 4.0/5.0 이상 달성
- 유료 API 사용 없이 완전 로컬 처리 검증

### 8.3 Phase 9.3: 학습 리뷰 및 통합 (2주)
**목표**: 시간 기반 학습 분석 및 기존 시스템 통합

**주요 작업**:
- `LearningReviewer` 클래스 구현
- 주간/월간 학습 활동 패턴 분석 알고리즘
- 주제별 진전도 측정 및 시각화
- MOC 생성, 지식 그래프와의 연동
- 전체 CLI 명령어 체계 완성 (`review` 명령어 추가)

**완료 기준**:
- 주간/월간 학습 리뷰 자동 생성 성공
- 기존 검색/MOC/태깅 기능과의 원활한 연동
- 전체 시스템 통합 테스트 통과

## 9. 위험 요소 및 완화 방안

### 9.1 기술적 위험

#### 위험 1: Claude Code LLM 성능 한계
- **위험도**: 중
- **영향**: 요약 품질이 유료 API 대비 현저히 떨어질 가능성
- **완화 방안**:
  - 사전 테스트를 통한 Claude Code LLM 성능 검증
  - 계층적 요약으로 입력 크기 최적화
  - 프롬프트 엔지니어링을 통한 출력 품질 향상
  - 필요시 사용자 선택형 유료 API 옵션 추가 고려

#### 위험 2: 대용량 문서 처리 성능
- **위험도**: 중
- **영향**: 수천 개 문서 처리 시 과도한 처리 시간
- **완화 방안**:
  - 점진적 클러스터링 및 배치 처리 적용
  - 캐싱 시스템 최대 활용
  - 사용자 설정 가능한 처리 크기 제한
  - 백그라운드 처리 및 진행률 표시

### 9.2 사용자 경험 위험

#### 위험 3: 클러스터링 결과의 직관성 부족
- **위험도**: 중
- **영향**: 자동 그룹화 결과가 사용자 기대와 불일치
- **완화 방안**:
  - 클러스터별 대표 문서 및 키워드 명확한 표시
  - 사용자 피드백 기반 클러스터링 파라미터 조정
  - 수동 조정 옵션 제공
  - 다양한 클러스터링 방법 선택 가능

### 9.3 비즈니스 위험

#### 위험 4: 사용자 채택률 저조
- **위험도**: 낮음
- **영향**: 개발된 기능의 실제 사용률이 낮을 가능성  
- **완화 방안**:
  - 핵심 사용자(저자) 요구사항 기반 설계
  - 점진적 기능 출시 및 사용자 피드백 반영
  - 기존 워크플로우와의 자연스러운 통합
  - 충분한 문서화 및 사용 예제 제공

## 10. 품질 보증 및 테스트 계획

### 10.1 기능 테스트

#### 10.1.1 클러스터링 품질 테스트
```python
def test_clustering_quality():
    """클러스터링 결과의 품질 검증"""
    # 실루엣 점수 0.5 이상
    # 클러스터 내 유사도 vs 클러스터 간 유사도 검증
    # 동일 주제 문서의 동일 클러스터 할당률 80% 이상
```

#### 10.1.2 요약 품질 테스트
```python
def test_summary_quality():
    """요약 품질 검증"""
    # 핵심 키워드 포함률 90% 이상  
    # 중복 내용 5% 이하
    # 사용자 평가 점수 4.0/5.0 이상
```

### 10.2 성능 테스트

#### 10.2.1 처리 시간 테스트
- 100개 문서: 5분 이하
- 1000개 문서: 30분 이하  
- 10000개 문서: 3시간 이하

#### 10.2.2 메모리 사용량 테스트
- 최대 메모리 사용량 8GB 이하 (M1 Pro 기준)
- 메모리 누수 없음 확인
- 배치 처리 최적화 검증

### 10.3 통합 테스트

#### 10.3.1 기존 시스템 연동 테스트
- BGE-M3 임베딩 캐시 재사용 정상 작동
- MOC 생성과의 데이터 연계 검증
- 검색 시스템과의 결과 일관성 확인

#### 10.3.2 CLI 인터페이스 테스트
- 모든 명령어 옵션 정상 작동
- 오류 상황 적절한 에러 메시지 표시
- 도움말 및 사용법 정확성 검증

## 11. 출시 및 운영 계획

### 11.1 베타 테스트 계획
- **기간**: Phase 9.3 완료 후 1주
- **대상**: 핵심 사용자(기술서 저자) 및 내부 테스터
- **목표**: 실사용 환경에서의 품질 및 사용성 검증

### 11.2 문서화 계획
- **사용자 가이드**: CLI 명령어 상세 설명 및 사용 예제
- **API 문서**: 프로그래밍 방식 사용을 위한 개발자 문서
- **튜토리얼**: 단계별 기능 활용 방법 안내

### 11.3 향후 확장 계획
- **시각화 대시보드**: 웹 기반 요약 결과 시각화
- **협업 기능**: 팀 단위 문서 요약 및 공유
- **고급 분석**: 지식 격차 분석 및 학습 최적화 제안

## 12. 결론

다중 문서 요약 시스템(Phase 9)은 Vault Intelligence System V2의 핵심 가치인 "지능형 지식 관리"를 한층 발전시키는 중요한 확장 기능입니다. 

**핵심 차별화 요소**:
- **순수 콘텐츠 기반**: 폴더 구조에 구애받지 않는 진정한 의미적 문서 발견
- **비용 효율성**: 유료 API 없이도 고품질 요약을 제공하는 지속 가능한 솔루션
- **시스템 통합**: 기존 기능들과의 자연스러운 연계로 시너지 극대화

이 시스템을 통해 "AI 시대의 TDD 활용" 책 저술 과정에서 방대한 자료를 체계적으로 정리하고, 연구자와 학습자들이 효율적인 지식 관리를 할 수 있는 강력한 도구를 제공할 것입니다.

---

**문서 정보**:
- 작성일: 2024년 8월 24일
- 버전: v1.0
- 담당자: Vault Intelligence Development Team
- 검토자: 기술서 저자 및 핵심 사용자